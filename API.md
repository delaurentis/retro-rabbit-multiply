# API Concepts

**Games** have a unique ID and 2 boards.

**Players** access games with their secret.

**Player-Secret** is generated by the server when a game is created or joined.

```
{ 
  game: { id: 143 }, 
  player: { secret: '444ae792-a96c-42e8-bd20-778f37c42a6e' }
}
```

It should be passed as a header for each subsequent API request.

```
HEADER Player-Secret: 444ae792-a96c-42e8-bd20-778f37c42a6e
```

**Game State** is returned from every non-error API call.
```
RESPONSE: 200 
{
  game: { id: 143, score: 4, min: 2, max: 9, hearts: 3 },
  player: {
    action: 'playing'
  },
  problems: [
    { id: 1001, a: 5, b: 8, answer: 40, jackpot: 9, score: 4 }
  ]
}
```

**Error** messages can appear in response to any API call. 

```
RESPONSE: 200 
{
  error: { message: 'Oops! You got the wrong answer.' }
}
```

**Turns** are managed by the API, and appear in the response as `player.action`

```
player { action: 'waiting' } = ‚è≥ Waiting for something to happen.
player { action: 'watching' } = üëÄ Watching another player
player { action: 'playing' } = ü§î Player's turn to guess. 
```

**Winning** is managed by the API, and also appears in `player.action`

```
player { action: 'celebrating' } = üéâ Player won!
player { action: 'crying' } = üò¢ Player lost!
```

<br>

# API Calls

**Start** a new game.

```
POST /api/game
BODY: { min: 2, max: 9, hearts: 3 }

RESPONSE: 200
{ 
  game: { id: 143, min: 2, max: 9, hearts: 3 }, 
  player: { secret: 'fc94a7e0-0be4-4e79-bead-ae68f9c95237'
            action: 'placing' } 
}
```

**Answer** a problem

```
PUT /api/game/143/problem/1001 
HEADER Player-Secret: 444ae792-a96c-42e8-bd20-778f37c42a6e
BODY: { answer: 40, score: 4 }

RESPONSE: 200
{
  game: { id: 143, score: 4, min: 2, max: 9, hearts: 3 },
  player: {
    action: 'playing'
  },
  problems: [
    { id: 1001, a: 5, b: 8, answer: 40, jackpot: 9, score: 4 }
  ]
}
```

**Refresh** the game state locally.  Do periodically while `player.action` is `waiting`

```
GET /api/game/143
HEADER Player-Secret: 444ae792-a96c-42e8-bd20-778f37c42a6e

RESPONSE: 200
{
  game: { id: 143, score: 4, min: 2, max: 9, hearts: 3 },
  player: {
    action: 'playing'
  },
  problems: [
    { id: 1001, a: 5, b: 8, answer: 40, jackpot: 9, score: 4 }
  ]
}

```
